{% extends "dashboard/index.html" %} {% block content %} {% load static %}
<h1>Camaras</h1>

<div class="row">
	<div class="col-2">
		<button type="button" class="btn btn-primary" data-coreui-toggle="modal" data-coreui-target="#createCameraModal" >
			Agregar cámara
		</button>
	</div>
</div>
<br>
<div class="row">
	<table class="table">
		<thead>
			<tr>
				<th scope="col">#</th>
				<th scope="col">ID</th>
				<th scope="col">Cámara</th>
				<th scope="col">RTSP</th>
				<th scope="col">Servicios</th>
				<th scope="col">Vista</th>
				<th scope="col">Editar</th>
				<th scope="col">Eliminar</th>
			</tr>
		</thead>
		<tbody>
			{% for camera in cameras %}
				<tr>
					<th scope="row">{{ forloop.counter }}</th>
					<th>{{ camera.camera_id }}</th>
					<td>{{camera.name}}</td>
					<td>{{camera.rtsp}}</td>
					<td>
						{% if camera.peop_c_service %}
							Contéo de personas
						{% elif camera.face_rec_service %}
							Reconocimiento facial
						{% elif camera.vehicles_service %}
							Registro de placas vehiculares
						{% else %}
							Sin servicios activos
						{% endif %}
					</td>
					<td>
						{% comment %} <form action="{% url 'send_message' %}" method="post" id="watchCamera_form"> {% endcomment %}
						<form action="" method="post" id="watchCamera_form">
							{% csrf_token %}
							<input type="hidden" name="camera_id" value="{{ camera.camera_id }}">
							<button class="btn btn-secondary btn-logo" id="watchCameraForm_btn">
								<span class="material-symbols-outlined">visibility</span>
							</button>
						</form>
					</td>
					<td>
						<a href="{% url 'edit_camera' id=camera.camera_id %}" class="btn btn-primary">
							<span class="material-symbols-outlined">edit</span>
						</a>
					</td>
					<td>
						<a href="{% url 'delete_camera' id=camera.camera_id %}" class="btn btn-danger">
							<span class="material-symbols-outlined">delete</span>
						</a>
					</td>
				</tr>
			{% endfor %}
		</tbody>
	</table>
</div>
<div class="row">
	Cameras list: {{ cameras_list }} <br>
	Has previous: {{ cameras_list.has_previous }} <br>
	Has next: {{ cameras_list.has_next }} <br>
	Current page: {{ cameras_list.number }} <br>
	Number of pages: {{ cameras_list.paginator.num_pages }} <br>
	Paginator: {{ cameras_list.paginator }}<br>
</div>
<div class="content">
	{% if cameras_list.has_previous %}
		<a href="?page=1">&laquo First</a>
		<a href="?page={{ cameras_list.previous_page_number }}">Previous</a>
	{% endif %}
	Page {{ cameras_list.number }} of {{ cameras_list.paginator.num_pages }}
	{% if cameras_list.has_next %}
		<a href="?page={{ cameras_list.next_page_number}}">Next</a>
		<a href="?page={{ cameras_list.paginator.num_pages }}">Last &raquo</a>
	{% endif %}
</div>
<br>

<div class="row">
	{% if result and result != 'No response from server.' %}
	<div class="row">
		<div id="videoContainer" style="padding: 0">
			<img id="videoFromCV" src="{% url 'video_feed' %}?result={{ result }}" />
		</div>
	</div>
	{% endif %}
</div>
<br>

<!-- Create Modal -->
{% include 'cameras_admin/forms/create.html' %}

<!-- Update Modal -->
{% include 'cameras_admin/forms/update.html' %}

<!-- Delete Modal -->
{% include 'cameras_admin/forms/delete.html' %}

{% endblock %}
